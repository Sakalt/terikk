<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç≤„Éº„É†</title>
    <style>
        /* „Çπ„Çø„Ç§„É´„ÅÆËøΩÂä† */
        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #f0f0f0;
        }
        #player {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: #f00;
        }
        #hp-bar, #mana-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 20px;
            background-color: #f00;
            width: 100px;
        }
        #mana-bar {
            top: 25px;
            background-color: #00f;
        }
        #inventory {
            position: fixed;
            top: 0;
            right: 0;
            width: 200px;
            height: 100vh;
            background-color: #fff;
            border: 1px solid #000;
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 12„Çπ„É≠„ÉÉ„Éà */
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            overflow-y: auto;
        }
        .inventory-slot {
            width: 100%;
            height: 100%;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #craft-menu {
            position: fixed;
            bottom: 0;
            right: 0;
            background-color: #fff;
            border: 1px solid #000;
            padding: 10px;
        }
        #craft-items {
            margin-bottom: 10px;
        }
        .enemy {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: #0f0;
        }
        #barrier {
            position: absolute;
            width: 200px;
            height: 20px;
            background-color: #aaa;
            top: 100px; /* ‰ΩçÁΩÆ„ÇíË™øÊï¥ */
            left: 50%;
            transform: translateX(-50%);
        }
        .block {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: #ddd;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="player"></div>
        <div id="hp-bar"></div>
        <div id="mana-bar"></div>
        <div id="barrier"></div> <!-- „Å∏„Å†„Å¶(„É¢„Éñ„ÅåË∂ä„Åà„Çâ„Çå„Å™„ÅÑ) -->
        <div id="enemies-container"></div>
        <!-- „Ç≤„Éº„É†ÂÜÖ„Éñ„É≠„ÉÉ„ÇØ -->
        <div id="blocks-container"></div>
    </div>
    <div id="inventory">
        <!-- 12„Çπ„É≠„ÉÉ„Éà„ÅÆ„Ç§„É≥„Éô„É≥„Éà„É™ -->
        <div class="inventory-slot"></div>
        <!-- (ÁúÅÁï•: ÂêàË®à12„Çπ„É≠„ÉÉ„Éà) -->
    </div>
    <div id="craft-menu" style="display: none;">
        <div id="craft-items"></div>
        <button id="craft-btn">„ÇØ„É©„Éï„Éà</button>
    </div>
    <button id="attack-btn">ÊîªÊíÉ</button>
    <button id="use-potion-btn">„Éù„Éº„Ç∑„Éß„É≥‰ΩøÁî®</button>
    <button id="save-btn">„Çª„Éº„Éñ</button>
    <button id="load-btn">„É≠„Éº„Éâ</button>
    <input type="text" id="search-box" placeholder="„Ç¢„Ç§„ÉÜ„É†Ê§úÁ¥¢">
    <button id="search-btn">Ê§úÁ¥¢</button>
    <input type="text" id="command-box" placeholder="„Ç≥„Éû„É≥„ÉâÂÖ•Âäõ">
    <button id="execute-cmd-btn">„Ç≥„Éû„É≥„ÉâÂÆüË°å</button>
    <button id="weather-btn">Â§©Ê∞óÂ§âÊõ¥</button>
    <button id="time-btn">ÊôÇÈñìÂ§âÊõ¥</button>
    <script>
        // „Ç¢„Ç§„ÉÜ„É†„ÄÅÈâ±Áü≥„ÄÅ„Éñ„É≠„ÉÉ„ÇØ„ÄÅÊïµ„ÄÅ„Éù„Éº„Ç∑„Éß„É≥„ÄÅ„Ç¢„ÇØ„Çª„Çµ„É™„Éº„ÄÅÂäπÊûú„ÅÆÂÆöÁæ©
        const items = [
            { name: "Ââ£", type: "weapon", attackPower: 15, attackSpeed: 1000, element: "‚öîÔ∏è" },
            { name: "Âºì", type: "weapon", attackPower: 10, attackSpeed: 1200, element: "üèπ" },
            { name: "ÂõûÂæ©„Éù„Éº„Ç∑„Éß„É≥", type: "potion", healAmount: 20, element: "üç∑" },
            { name: "Êúà„Éù„Éº„Ç∑„Éß„É≥", type: "potion", healAmount: 100, element: "üç∑üåï" },
            { name: "„ÉÑ„Éº„É´", type: "tool", effect: "useTool", element: "üîß" },
            { name: "„Éè„É≥„Éû„Éº", type: "tool", effect: "build", element: "üî®" },
            { name: "„Å§„Çã„ÅØ„Åó", type: "tool", effect: "mine", element: "‚õèÔ∏è" }
        ];

        const ores = [
            { name: "ÈâÑÈâ±Áü≥", hardness: 5, element: "‚õèÔ∏è" },
            { name: "ÈáëÈâ±Áü≥", hardness: 7, element: "‚õèÔ∏è" },
            { name: "„ÉÄ„Ç§„É§Èâ±Áü≥", hardness: 10, element: "‚õèÔ∏è" },
            { name: "ÈäÖÈâ±Áü≥", hardness: 3, element: "‚õèÔ∏è" },
            { name: "ÈäÄÈâ±Áü≥", hardness: 6, element: "‚õèÔ∏è" }
        ];

        const blocks = [
            { name: "Áü≥", hardness: 2, element: "üß±" },
            { name: "Êú®Êùê", hardness: 1, element: "ü™µ" },
            { name: "Âúü", hardness: 1, element: "üåø" },
            { name: "Á†Ç", hardness: 1, element: "üèñÔ∏è" },
            { name: "ÊúàÁü≥", hardness: 25, element: "üåï" },
            { name: "„Ç≥„É≥„ÇØ„É™„Éº„Éà", hardness: 4, element: "ü™®" },
            { name: "„Å∏„Å†„Å¶„Éñ„É≠„ÉÉ„ÇØ", hardness: 100, element: "üõ°Ô∏è" } // „Å∏„Å†„Å¶„Éñ„É≠„ÉÉ„ÇØ
        ];

        const enemies = [
            { name: "„Ç¥„Éñ„É™„É≥", health: 30, damage: 10, speed: 2, element: "üëπ", poison: false },
            { name: "„Ç¥„Éº„Çπ„Éà", health: 25, damage: 8, speed: 1.5, element: "üëª", poison: false },
            { name: "„Çπ„É©„Ç§„É†", health: 15, damage: 5, speed: 1, element: "ü™≤", poison: true },
            { name: "ÊØíËõá", health: 20, damage: 7, speed: 1.2, element: "üêç", poison: true },
            { name: "„Éâ„É©„Ç¥„É≥", health: 50, damage: 15, speed: 3, element: "üêâ", poison: false }
        ];

        const potions = [
            { name: "ÂõûÂæ©„Éù„Éº„Ç∑„Éß„É≥", healAmount: 20, element: "üç∑" },
            { name: "„Éû„Éä„Éù„Éº„Ç∑„Éß„É≥", manaAmount: 10, element: "üçª" },
            { name: "Âäõ„ÅÆ„Éù„Éº„Ç∑„Éß„É≥", strengthAmount: 5, element: "üí™" },
            { name: "„Çπ„Éî„Éº„Éâ„Éù„Éº„Ç∑„Éß„É≥", speedAmount: 5, element: "üöÄ" },
            { name: "ÊØíÊ∂à„Åó", poisonAmount: -10, element: "üíä" }
        ];

        const accessories = [
            { name: "„É™„É≥„Ç∞", effect: "attackBoost", value: 5, element: "üíç" },
            { name: "Â∏ΩÂ≠ê", effect: "defenseBoost", value: 3, element: "üß¢" },
            { name: "„Éû„É≥„Éà", effect: "speedBoost", value: 5, element: "üß•" }
        ];

        const effects = [
            { name: "Ëºù„Åç", type: "buff", element: "‚ú®" },
            { name: "Á´úÂ∑ª", type: "debuff", element: "üå™Ô∏è" },
            { name: "ÁÖô", type: "debuff", element: "üå´Ô∏è" }
        ];

        // „ÇØ„É©„Éï„Éà„É¨„Ç∑„Éî
        const recipes = {
            "ÈâÑ„ÅÆÂâ£": ["ÈâÑÈâ±Áü≥", "Êú®Êùê"],
            "Èáë„ÅÆÂºì": ["ÈáëÈâ±Áü≥", "Êú®Êùê"],
            "ÊúàÁü≥": ["Á†Ç", "Áü≥"],
            "„É™„É≥„Ç∞": ["ÈáëÈâ±Áü≥", "„ÉÄ„Ç§„É§Èâ±Áü≥"],
            "„ÉÄ„Ç§„É§„ÅÆ„ÉÑ„É´„Éè„Ç∑": ["„ÉÄ„Ç§„É§Èâ±Áü≥", "Êú®Êùê"]
        };

        // „Éó„É¨„Ç§„É§„Éº„ÅÆÁä∂ÊÖã
        const player = {
            x: 100,
            y: 100,
            hp: 100,
            mana: 50,
            inventory: [],
            attackPower: 10,
            lastAttackTime: 0,
            attackSpeed: 1000 // Ê≠¶Âô®„ÅÆÊîªÊíÉÈÄüÂ∫¶ („Éü„É™Áßí)
        };

        let enemiesList = [];
        let blocksList = [];

        // „Ç¢„Ç§„ÉÜ„É†Ê§úÁ¥¢
        function acquireSearchedItems(query) {
            const foundItems = items.filter(item => item.name.includes(query));
            foundItems.forEach(item => {
                player.inventory.push(item);
                console.log(`${item.name} „ÇíÂèñÂæó„Åó„Åæ„Åó„Åü`);
            });
            updateInventoryDisplay();
        }

        // „Éî„Çπ„Éà„É≥„ÅÆÂãï‰Ωú
        function operatePiston(x, y, direction) {
            const block = document.querySelector(`.block[data-x='${x}'][data-y='${y}']`);
            if (block) {
                if (direction === 'push') {
                    block.style.transform = `translateY(${50}px)`; // „Éî„Çπ„Éà„É≥„ÅßÊäº„Åô
                } else if (direction === 'pull') {
                    block.style.transform = `translateY(${0}px)`; // „Éî„Çπ„Éà„É≥„ÅßÂºï„Åè
                }
            }
        }

        // „Ç≥„Éû„É≥„Éâ„ÅÆÂÆüË°å
        function executeCommand(command) {
            switch (command) {
                case 'give_item':
                    player.inventory.push({ name: 'Êñ∞„Ç¢„Ç§„ÉÜ„É†', element: 'üî®' });
                    break;
                case 'spawn_enemy':
                    spawnEnemy();
                    break;
                case 'spawn_block':
                    spawnBlock();
                    break;
                // „Åù„ÅÆ‰ªñ„ÅÆ„Ç≥„Éû„É≥„Éâ„ÇíËøΩÂä†
            }
        }

        // „Ç≥„Éû„É≥„Éâ„Éñ„É≠„ÉÉ„ÇØ„ÅÆÂÆüË£Ö
        function useCommandBlock(command) {
            executeCommand(command);
        }

        // Â§©Ê∞ó„ÅÆÂ§âÊõ¥
        function changeWeather(weather) {
            document.getElementById('game-container').style.backgroundColor = weather === 'rain' ? '#a8d0e6' : '#f0f0f0';
            player.weather = weather;
        }

        // ÊôÇÈñì„ÅÆÂ§âÊõ¥
        function changeTime(time) {
            console.log(`ÊôÇÈñì„Çí${time}„Å´Â§âÊõ¥„Åó„Åæ„Åó„Åü„ÄÇ`);
            player.time = time;
        }

        // „Ç¢„Ç§„ÉÜ„É†„Å®Êïµ„ÅÆ„Çπ„Éù„Éº„É≥„ÇíÈñãÂßã
        function startSpawning() {
            setInterval(spawnItem, 5000); // 5Áßí„Åî„Å®„Å´„Ç¢„Ç§„ÉÜ„É†„Çí„Çπ„Éù„Éº„É≥
            setInterval(spawnEnemy, 10000); // 10Áßí„Åî„Å®„Å´Êïµ„Çí„Çπ„Éù„Éº„É≥
        }

        // „Ç¢„Ç§„ÉÜ„É†„Çí„Çπ„Éù„Éº„É≥
        function spawnItem() {
            const item = items[Math.floor(Math.random() * items.length)];
            console.log(`„Ç¢„Ç§„ÉÜ„É†„Çí„Çπ„Éù„Éº„É≥: ${item.name}`);
        }

        // Êïµ„Çí„Çπ„Éù„Éº„É≥
        function spawnEnemy() {
            const enemy = enemies[Math.floor(Math.random() * enemies.length)];
            enemiesList.push(enemy);
            console.log(`Êïµ„Çí„Çπ„Éù„Éº„É≥: ${enemy.name}`);
            renderEnemies();
        }

        // „Éñ„É≠„ÉÉ„ÇØ„Çí„Çπ„Éù„Éº„É≥
        function spawnBlock() {
            const block = blocks[Math.floor(Math.random() * blocks.length)];
            blocksList.push(block);
            console.log(`„Éñ„É≠„ÉÉ„ÇØ„Çí„Çπ„Éù„Éº„É≥: ${block.name}`);
            renderBlocks();
        }

        // Êïµ„Çí„É¨„É≥„ÉÄ„É™„É≥„Ç∞
        function renderEnemies() {
            const enemiesContainer = document.getElementById('enemies-container');
            enemiesContainer.innerHTML = '';
            enemiesList.forEach(enemy => {
                const enemyElement = document.createElement('div');
                enemyElement.className = 'enemy';
                enemyElement.innerText = enemy.element;
                enemyElement.style.left = `${Math.random() * 80}vw`;
                enemyElement.style.top = `${Math.random() * 80}vh`;
                enemiesContainer.appendChild(enemyElement);
            });
        }

        // „Éñ„É≠„ÉÉ„ÇØ„Çí„É¨„É≥„ÉÄ„É™„É≥„Ç∞
        function renderBlocks() {
            const blocksContainer = document.getElementById('blocks-container');
            blocksContainer.innerHTML = '';
            blocksList.forEach(block => {
                const blockElement = document.createElement('div');
                blockElement.className = 'block';
                blockElement.innerText = block.element;
                blockElement.style.left = `${Math.random() * 80}vw`;
                blockElement.style.top = `${Math.random() * 80}vh`;
                blockElement.dataset.x = Math.floor(Math.random() * 100);
                blockElement.dataset.y = Math.floor(Math.random() * 100);
                blocksContainer.appendChild(blockElement);
            });
        }

        // „Éó„É¨„Ç§„É§„Éº„Å®Êïµ„ÅÆÊîªÊíÉÂà§ÂÆö
        function attack() {
            const now = Date.now();
            if (now - player.lastAttackTime >= player.attackSpeed) {
                player.lastAttackTime = now;
                // Ê≠¶Âô®„ÅÆÊîªÊíÉÂá¶ÁêÜ
                enemiesList.forEach(enemy => {
                    if (isInRange(player, enemy)) {
                        enemy.health -= player.attackPower;
                        if (enemy.health <= 0) {
                            console.log(`${enemy.name} „ÇíÂÄí„Åó„Åæ„Åó„ÅüÔºÅ`);
                            enemiesList = enemiesList.filter(e => e !== enemy);
                        }
                    }
                });
            }
        }

        // „Éó„É¨„Ç§„É§„Éº„Å®Êïµ„ÅÆË∑ùÈõ¢„ÇíË®àÁÆó
        function isInRange(player, enemy) {
            const playerRect = document.getElementById('player').getBoundingClientRect();
            const enemyRect = document.querySelector('.enemy').getBoundingClientRect();
            return !(playerRect.right < enemyRect.left || 
                     playerRect.left > enemyRect.right || 
                     playerRect.bottom < enemyRect.top || 
                     playerRect.top > enemyRect.bottom);
        }

        // „Éó„É¨„Ç§„É§„Éº„ÅÆÊ≠ª‰∫°Âá¶ÁêÜ
        function playerDeath() {
            alert('„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº');
            // „É™„Çª„ÉÉ„Éà„ÇÑ„É°„Éã„É•„Éº„Å∏„ÅÆÈÅ∑Áßª„Å™„Å©„ÇíËøΩÂä†
        }

        // „Å∏„Å†„Å¶„ÅÆËøΩÂä†
        function createBarrier() {
            const barrier = document.getElementById('barrier');
            barrier.style.display = 'block';
        }

        // „Éñ„É≠„ÉÉ„ÇØ„ÅÆÁ†¥Â£ä
        function destroyBlock(x, y) {
            const block = document.querySelector(`.block[data-x='${x}'][data-y='${y}']`);
            if (block) {
                block.remove();
                blocksList = blocksList.filter(b => b !== block);
                console.log('„Éñ„É≠„ÉÉ„ÇØ„ÅåÁ†¥Â£ä„Åï„Çå„Åæ„Åó„Åü');
            }
        }

        // „Éñ„É≠„ÉÉ„ÇØ„ÅÆË®≠ÁΩÆ
        function placeBlock(x, y, block) {
            const blockElement = document.createElement('div');
            blockElement.className = 'block';
            blockElement.innerText = block.element;
            blockElement.style.left = `${x}px`;
            blockElement.style.top = `${y}px`;
            blockElement.dataset.x = x;
            blockElement.dataset.y = y;
            document.getElementById('blocks-container').appendChild(blockElement);
            blocksList.push(block);
            console.log('„Éñ„É≠„ÉÉ„ÇØ„ÅåË®≠ÁΩÆ„Åï„Çå„Åæ„Åó„Åü');
        }

        // „Ç≤„Éº„É†ÈñãÂßã
        function init() {
            loadGameState();
            updatePlayerPosition();
            updateInventoryDisplay();
            updatePlayerStatus();
            startSpawning(); // „Ç¢„Ç§„ÉÜ„É†„Å®Êïµ„ÅÆ„Çπ„Éù„Éº„É≥„ÇíÈñãÂßã
            createBarrier(); // „Å∏„Å†„Å¶„Çí‰ΩúÊàê
            renderEnemies();
            renderBlocks();
        }

        // „Ç≤„Éº„É†Áä∂ÊÖã„ÅÆ‰øùÂ≠ò
        function saveGameState() {
            localStorage.setItem('player', JSON.stringify(player));
            localStorage.setItem('enemies', JSON.stringify(enemiesList));
            localStorage.setItem('blocks', JSON.stringify(blocksList));
            console.log('„Ç≤„Éº„É†„ÅÆÁä∂ÊÖã„Åå‰øùÂ≠ò„Åï„Çå„Åæ„Åó„Åü„ÄÇ');
        }

        // „Ç≤„Éº„É†Áä∂ÊÖã„ÅÆ„É≠„Éº„Éâ
        function loadGameState() {
            const savedPlayer = localStorage.getItem('player');
            const savedEnemies = localStorage.getItem('enemies');
            const savedBlocks = localStorage.getItem('blocks');
            if (savedPlayer) {
                Object.assign(player, JSON.parse(savedPlayer));
                console.log('„Ç≤„Éº„É†„ÅÆÁä∂ÊÖã„Åå„É≠„Éº„Éâ„Åï„Çå„Åæ„Åó„Åü„ÄÇ');
            }
            if (savedEnemies) {
                enemiesList = JSON.parse(savedEnemies);
                renderEnemies();
            }
            if (savedBlocks) {
                blocksList = JSON.parse(savedBlocks);
                renderBlocks();
            }
        }

        // „Ç§„É≥„Éô„É≥„Éà„É™„ÅÆË°®Á§∫„ÇíÊõ¥Êñ∞
        function updateInventoryDisplay() {
            const inventory = document.getElementById('inventory');
            inventory.innerHTML = '';
            player.inventory.forEach(item => {
                const slot = document.createElement('div');
                slot.className = 'inventory-slot';
                slot.innerText = item.element;
                inventory.appendChild(slot);
            });
        }

        // „Éó„É¨„Ç§„É§„Éº„ÅÆÁä∂ÊÖã„ÇíÊõ¥Êñ∞
        function updatePlayerStatus() {
            document.getElementById('hp-bar').style.width = `${player.hp}%`;
            // „Åù„ÅÆ‰ªñ„ÅÆ„Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫„ÇíËøΩÂä†
        }

        // „Éó„É¨„Ç§„É§„Éº„ÅÆ‰ΩçÁΩÆ„ÇíÊõ¥Êñ∞
        function updatePlayerPosition() {
            const playerElement = document.getElementById('player');
            playerElement.style.left = `${player.x}px`;
            playerElement.style.top = `${player.y}px`;
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆËøΩÂä†
        document.getElementById('search-btn').addEventListener('click', () => {
            const query = document.getElementById('search-box').value;
            acquireSearchedItems(query);
        });

        document.getElementById('execute-cmd-btn').addEventListener('click', () => {
            const command = document.getElementById('command-box').value;
            executeCommand(command);
        });

        document.getElementById('weather-btn').addEventListener('click', () => {
            changeWeather('rain'); // „Çµ„É≥„Éó„É´: Èõ®„Å´Â§âÊõ¥
        });

        document.getElementById('time-btn').addEventListener('click', () => {
            changeTime('day'); // „Çµ„É≥„Éó„É´: Êòº„Å´Â§âÊõ¥
        });

        document.getElementById('save-btn').addEventListener('click', saveGameState);
        document.getElementById('load-btn').addEventListener('click', loadGameState);
        document.getElementById('attack-btn').addEventListener('click', attack);
        document.getElementById('use-potion-btn').addEventListener('click', () => {
            const potion = player.inventory.find(item => item.type === 'potion');
            if (potion) {
                player.hp = Math.min(100, player.hp + potion.healAmount);
                console.log(`${potion.name} „Çí‰ΩøÁî®„Åó„Åæ„Åó„Åü`);
            }
        });

        init();
    </script>
</body>
</html>
